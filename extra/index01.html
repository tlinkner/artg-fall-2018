<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Document</title>
<style>
body {
  margin: 3em;
  font-family: sans-serif;
}
.plot {
  margin: 1em;
  float: left;
  width: 300px;
  height: 300px;
  background: #eee;
  
}
</style>
</head>
<body>

<h1>Anscombe</h1>
    
<div class="plot" id="plot1"></div>    
<div class="plot" id="plot2"></div>    
<div class="plot" id="plot3"></div>    
<div class="plot" id="plot4"></div>    
    
<script src="d3.min.js"></script>      
<script>

const m = {t:50, r:50, b:50, l:50};
const w = d3.select('.plot').node().clientWidth - m.l - m.r;
const h = d3.select('.plot').node().clientHeight - m.t - m.b;

const data=d3.csv('anscombe.csv', parse);

function parse(d){
  return {
    x1:+d.x1,
    x2:+d.x2,
    x3:+d.x3,
    x4:+d.x4,
    y1:+d.y1,
    y2:+d.y2,
    y3:+d.y3,
    y4:+d.y4
  }
}

data.then(function(rows){
  
  // scaling functinos
  const sX = d3.scaleLinear()
    .domain([0,20])
    .range([0,w]);
  const sY = d3.scaleLinear()
    .domain([0,20])
    .range([h,0]);
  const plot1 = d3.selectAll('#plot1')
    .append('svg')
    .attr('width',w + m.l + m.r)
    .attr('height',h + m.t + m.b)
    .append('g')
    .attr('transform',`translate(${m.l},${m.t})`);
  const plot2 = d3.selectAll('#plot2')
    .append('svg')
    .attr('width',w + m.l + m.r)
    .attr('height',h + m.t + m.b)
    .append('g')
    .attr('transform',`translate(${m.l},${m.t})`);
  const plot3 = d3.selectAll('#plot3')
    .append('svg')
    .attr('width',w + m.l + m.r)
    .attr('height',h + m.t + m.b)
    .append('g')
    .attr('transform',`translate(${m.l},${m.t})`);
  const plot4 = d3.selectAll('#plot4')
    .append('svg')
    .attr('width',w + m.l + m.r)
    .attr('height',h + m.t + m.b)
    .append('g')
    .attr('transform',`translate(${m.l},${m.t})`);
  // break out data
  const data1 = rows.map(function(d){
    return {
      x: d.x1,
      y: d.y1
    }
  });
  const data2 = rows.map(function(d){
    return {
      x: d.x2,
      y: d.y2
    }
  });
  const data3 = rows.map(function(d){
    return {
      x: d.x3,
      y: d.y3
    }
  });
  const data4 = rows.map(function(d){
    return {
      x: d.x4,
      y: d.y4
    }
  });
  // draw
  draw(plot1,data1,sX,sY);
  draw(plot2,data2,sX,sY);
  draw(plot3,data3,sX,sY);
  draw(plot4,data4,sX,sY);
  
});

function draw(selection, data, sX, sY){
  data.forEach(function(d) {
    selection.append('circle')
      .attr('cx',sX(d.x))
      .attr('cy',sY(d.y))
      .attr('r',6)
      .attr('opacity',0.2);
  });
}

</script>
</body>
</html>